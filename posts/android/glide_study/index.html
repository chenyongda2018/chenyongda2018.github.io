<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>Glideå­¦ä¹ ç¬”è®°</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  

  
  
    <link href="https://chenyongda2018.github.io/newfav.png" rel="icon">
  

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="">
  <meta name="author" content="Petrichor">

  
  <meta name="generator" content="Hugo 0.115.1">

  
  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="https://chenyongda2018.github.io/">Petrichor&#39;s blog</a></h1>
    <h2>Android developer.</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigateâ€¦</option>
      
        <option value="https://chenyongda2018.github.io/">Â» ä¸»é¡µ</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="https://chenyongda2018.github.io/" title="ä¸»é¡µ">ä¸»é¡µ</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="https://chenyongda2018.github.io/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:https://chenyongda2018.github.io/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Nov 14, 2019
     - 8 minute read 
    

    
    
      - <a class="label" href="https://chenyongda2018.github.io/categories/android/">Android </a>
    
  </p>
  <h1 class="entry-title">
     Glideå­¦ä¹ ç¬”è®° 
  </h1>
</header>


        <div class="entry-content">
          
          
          
            <nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸€ä½¿ç”¨">ä¸€.ä½¿ç”¨</a>
      <ul>
        <li><a href="#1é…ç½®ä¾èµ–">1.é…ç½®ä¾èµ–</a></li>
        <li><a href="#2åˆæ­¥ä¸Šæ‰‹">2.åˆæ­¥ä¸Šæ‰‹</a></li>
        <li><a href="#3é…åˆrecyclerviewæ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨">3.é…åˆRecyclerViewæ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨</a></li>
        <li><a href="#5ç¼“å­˜">5.ç¼“å­˜</a></li>
        <li><a href="#6ä½¿ç”¨ç¼©ç•¥å›¾thumbnail">6.ä½¿ç”¨ç¼©ç•¥å›¾(Thumbnail)</a></li>
        <li><a href="#7target">7.Target</a></li>
        <li><a href="#8è¿‡æ¸¡åŠ¨ç”»transitions">8.è¿‡æ¸¡åŠ¨ç”»(Transitions)</a></li>
        <li><a href="#9è‡ªå®šä¹‰module">9.è‡ªå®šä¹‰Module</a></li>
      </ul>
    </li>
    <li><a href="#äºŒæºç è§£æ">äºŒ.æºç è§£æ</a>
      <ul>
        <li><a href="#1glidewith--glideçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†">1.Glide.with() : Glideçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</a></li>
        <li><a href="#2loadurl-">2.load(url) :Â </a></li>
        <li><a href="#3into">3.into()</a></li>
      </ul>
    </li>
  </ul>
</nav>
          
          <h1 id="ä¸€ä½¿ç”¨">ä¸€.ä½¿ç”¨</h1>
<h2 id="1é…ç½®ä¾èµ–">1.é…ç½®ä¾èµ–</h2>
<p>åœ¨ <code>app</code>Â å±‚ <code>build.gradle</code>Â ä¸­æ·»åŠ ä¾èµ– :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>dependencies {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    implementation &#39;com.github.bumptech.glide:glide:4.9.0&#39;
</span></span><span style="display:flex;"><span>    annotationProcessor &#39;com.github.bumptech.glide:compiler:4.9.0&#39;
</span></span><span style="display:flex;"><span>    annotationProcessor &#39;androidx.annotation:annotation:1.1.0&#39;
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ·»åŠ å¿…è¦æƒé™ :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.INTERNET&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.ACCESS_NETWORK_STATE&#34;</span><span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span> <span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;uses-permission</span> android:name=<span style="color:#2aa198">&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span> <span style="color:#268bd2">/&gt;</span>
</span></span></code></pre></div><h2 id="2åˆæ­¥ä¸Šæ‰‹">2.åˆæ­¥ä¸Šæ‰‹</h2>
<p>ä»£ç  :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>context<span style="color:#719e07">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asBitmap<span style="color:#719e07">()</span> <span style="color:#586e75">//æŠŠåŠ¨å›¾å½“ä½œé™æ­¢å›¾ç‰‡å¤„ç†,ä¹Ÿå°±æ˜¯åªæ˜¾ç¤ºgifå›¾çš„ç¬¬ä¸€å¸§
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;https://pic2.zhimg.com/v2-c4970ee756c55333b7b871c5b617d9ed_b.gif&#34;</span><span style="color:#719e07">)</span><span style="color:#586e75">//å›¾ç‰‡url
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>placeholder<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>mipmap<span style="color:#719e07">.</span>ic_launcher<span style="color:#719e07">)</span>  <span style="color:#586e75">//å ä½ç¬¦,åœ¨åŠ è½½å›¾ç‰‡å®Œæˆä¹‹å‰æ˜¾ç¤ºçš„å›¾ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>error<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_background<span style="color:#719e07">)</span> <span style="color:#586e75">//åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºçš„å›¾ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>fitCenter<span style="color:#719e07">()</span> <span style="color:#586e75">//å½“å›¾ç‰‡é•¿å®½å¤§äºImageViewæ—¶,ç¼©æ”¾å›¾ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>fallback<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>mipmap<span style="color:#719e07">.</span>ic_launcher<span style="color:#719e07">)</span> <span style="color:#586e75">//å›¾ç‰‡urlä¸ºNullæ—¶æ˜¾ç¤ºçš„å›¾ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>image1<span style="color:#719e07">);</span> <span style="color:#586e75">// æ”¾å…¥åˆ°ImageViewä¸­
</span></span></span></code></pre></div><p>æ•ˆæœå›¾ :</p>
<!-- raw HTML omitted -->
<p>ğŸˆTips : fitCenter()ä¸CenterCrop()åŒºåˆ« :Â </p>
<ul>
<li>fitCenter() : æ•ˆæœå¦‚ä¸Šå›¾,ç¼©æ”¾åŸå›¾è‡³ImageViewå¤§å°ã€‚</li>
<li>CenterCrop():å¦‚ä¸‹å›¾,ä¿æŒåŸå›¾ä¸å˜ï¼Œåªæ ¹æ®ImageViewå¤§å°æ˜¾ç¤ºå¯¹åº”éƒ¨åˆ†ã€‚</li>
</ul>
<!-- raw HTML omitted -->
<h2 id="3é…åˆrecyclerviewæ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨">3.é…åˆRecyclerViewæ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨</h2>
<p>1.éœ€è¦åŠ è½½çš„å›¾ç‰‡urlæ•°æ®æº</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String<span style="color:#719e07">[]</span> mImageList <span style="color:#719e07">=</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/crop%3D0%2C231%2C438%&#34;</span> <span style="color:#719e07">+</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#2aa198">&#34;2C219%3BeWH%3D800%2C400/sign=b9c61bb42b3fb80e189e3b970be1031c/d50735fae6cd7b89267e2d06052442a7d9330e20.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://s3.ifanr.com/wp-content/uploads/2018/02/https_2F2Fhk.hypebeast.com2Ffiles2F20182F012Fdragon-ball-super-ending-anime-details-01-1.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=999dccfe8082b90139adc431438ca97e/a1ec08fa513d26970f8fef845ffbb2fb4216d88f.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;http://img5.mtime.cn/CMS/News/2019/05/28/223631.52706895_620X620.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;http://newsimg.5054399.com/uploads/userup/1902/2F95FQ953.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;http://x0.ifengimg.com/cmpp/2019_37/63ef72f4f79be26_size61_w1278_h716.jpg&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQJehCL30Zj-jAI8xxZ1eQI6mf9DuqaC6LXEOzF-Li8-Y1YlSnJ&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRTzaN89LyHy1IzuibIhUdvJjEiCdrn8R84BnUi4O6hlPtmJZWe&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQGFNu4QL1YIazFeV-hVtIv686UNFqJwjReiObeCmAZiFvl7CHJ&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQyMlTlY90LK_A_nbv8egC6yZkhvd4WmAHOoMzwVuGaH8VJKQga&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSNfpqnbeGqjIObnVpLipvUve0QGjT3PANsVoAEsKSvvmFdozMD&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTjTT47tCkv6wy93-JIno1Egv-0QQQ5rvKmSTZ9gZ5Jd64VPY2o&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#2aa198">&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQGFNu4QL1YIazFeV-hVtIv686UNFqJwjReiObeCmAZiFvl7CHJ&amp;s&#34;</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">};</span>
</span></span></code></pre></div><p>2.itemçš„å¸ƒå±€</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#268bd2">&lt;LinearLayout</span> xmlns:android=<span style="color:#2aa198">&#34;http://schemas.android.com/apk/res/android&#34;</span>
</span></span><span style="display:flex;"><span>    xmlns:app=<span style="color:#2aa198">&#34;http://schemas.android.com/apk/res-auto&#34;</span>
</span></span><span style="display:flex;"><span>    xmlns:tools=<span style="color:#2aa198">&#34;http://schemas.android.com/tools&#34;</span>
</span></span><span style="display:flex;"><span>    android:layout_width=<span style="color:#2aa198">&#34;match_parent&#34;</span>
</span></span><span style="display:flex;"><span>    android:layout_height=<span style="color:#2aa198">&#34;wrap_content&#34;</span><span style="color:#268bd2">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">&lt;ImageView</span>
</span></span><span style="display:flex;"><span>        android:id=<span style="color:#2aa198">&#34;@+id/imageView&#34;</span>
</span></span><span style="display:flex;"><span>        android:layout_width=<span style="color:#2aa198">&#34;wrap_content&#34;</span>
</span></span><span style="display:flex;"><span>        android:layout_height=<span style="color:#2aa198">&#34;150dp&#34;</span>
</span></span><span style="display:flex;"><span>        android:layout_margin=<span style="color:#2aa198">&#34;10dp&#34;</span>
</span></span><span style="display:flex;"><span>        android:layout_weight=<span style="color:#2aa198">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        tools:srcCompat=<span style="color:#2aa198">&#34;@tools:sample/avatars&#34;</span> <span style="color:#268bd2">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">&lt;/LinearLayout&gt;</span>
</span></span></code></pre></div><p>3.adapter</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">ImageListAdapter</span> <span style="color:#268bd2">extends</span> RecyclerView<span style="color:#719e07">.</span>Adapter<span style="color:#719e07">&lt;</span>ImageListAdapter<span style="color:#719e07">.</span>ViewHolder<span style="color:#719e07">&gt;</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">private</span> Context mContext<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">private</span> String<span style="color:#719e07">[]</span> mImageList<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">private</span> LayoutInflater mInflater<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    RequestOptions mOptions <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RequestOptions<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">.</span>placeholder<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>mipmap<span style="color:#719e07">.</span>ic_launcher<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">.</span>error<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_background<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#268bd2">ImageListAdapter</span><span style="color:#719e07">(</span>Context mContext<span style="color:#719e07">,</span> String<span style="color:#719e07">[]</span> mImageList<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">this</span><span style="color:#719e07">.</span>mContext <span style="color:#719e07">=</span> mContext<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">this</span><span style="color:#719e07">.</span>mImageList <span style="color:#719e07">=</span> mImageList<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        mInflater <span style="color:#719e07">=</span> LayoutInflater<span style="color:#719e07">.</span>from<span style="color:#719e07">(</span>mContext<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">ViewHolder</span> <span style="color:#268bd2">extends</span> RecyclerView<span style="color:#719e07">.</span>ViewHolder <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">public</span> ImageView imageView<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#268bd2">public</span> <span style="color:#268bd2">ViewHolder</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> View itemView<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#268bd2">super</span><span style="color:#719e07">(</span>itemView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>            imageView <span style="color:#719e07">=</span> <span style="color:#719e07">(</span>ImageView<span style="color:#719e07">)</span> itemView<span style="color:#719e07">.</span>findViewById<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>id<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> ImageListAdapter<span style="color:#719e07">.</span>ViewHolder <span style="color:#268bd2">onCreateViewHolder</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> ViewGroup parent<span style="color:#719e07">,</span> <span style="color:#dc322f">int</span> viewType<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>       View view <span style="color:#719e07">=</span> mInflater<span style="color:#719e07">.</span>inflate<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>layout<span style="color:#719e07">.</span>main_activity_list_item<span style="color:#719e07">,</span>parent<span style="color:#719e07">,</span><span style="color:#cb4b16">false</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>       <span style="color:#719e07">return</span> <span style="color:#719e07">new</span> ViewHolder<span style="color:#719e07">(</span>view<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onBindViewHolder</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> ImageListAdapter<span style="color:#719e07">.</span>ViewHolder holder<span style="color:#719e07">,</span> <span style="color:#dc322f">int</span> position<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>mImageList<span style="color:#719e07">[</span>position<span style="color:#719e07">])</span>
</span></span><span style="display:flex;"><span>                <span style="color:#719e07">.</span>apply<span style="color:#719e07">(</span>mOptions<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">public</span> <span style="color:#dc322f">int</span> <span style="color:#268bd2">getItemCount</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">return</span> mImageList<span style="color:#719e07">.</span>length<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><ol start="4">
<li>åœ¨activityä¸­ç»‘å®šRecyclerviewå’Œæ•°æ®æº</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>RecyclerView<span style="color:#719e07">.</span>LayoutManager linearLayoutManager <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> LinearLayoutManager<span style="color:#719e07">(</span>getApplicationContext<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>ImageListAdapter adapter <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> ImageListAdapter<span style="color:#719e07">(</span><span style="color:#719e07">this</span><span style="color:#719e07">,</span>mImageList<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mRecyclerView <span style="color:#719e07">=</span> findViewById<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>id<span style="color:#719e07">.</span>recyclerView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>mRecyclerView<span style="color:#719e07">.</span>setLayoutManager<span style="color:#719e07">(</span>linearLayoutManager<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>mRecyclerView<span style="color:#719e07">.</span>setAdapter<span style="color:#719e07">(</span>adapter<span style="color:#719e07">);</span>
</span></span></code></pre></div><p>æ•ˆæœå›¾:</p>
<!-- raw HTML omitted -->
<h2 id="5ç¼“å­˜">5.ç¼“å­˜</h2>
<ul>
<li>å†…å­˜ç¼“å­˜ :</li>
</ul>
<p>é€šè¿‡ skipMemoryCache(true)å¯ä»¥è®¾ç½®ä¸è¿›è¡Œå†…å­˜ç¼“å­˜Â  Â  Â </p>
<ul>
<li>ç£ç›˜ç¼“å­˜ :</li>
</ul>
<p>diskCacheStrategy(DiskCacheStrategy)
å‚æ•°ä¸­æœ‰å››ä¸ªé€‰é¡¹ :Â </p>
<ul>
<li>
<p>DiskCacheStrategy.ALL : æ—¢ç¼“å­˜åŸå›¾ä¹Ÿç¼“å­˜å¤„ç†å›¾</p>
</li>
<li>
<p>DiskCacheStrategy.NONE : å•¥éƒ½ä¸ç¼“å­˜ = ç¦ç”¨ç£ç›˜ç¼“å­˜</p>
</li>
<li>
<p>DiskCacheStrategy.SOURCE : åªç¼“å­˜åŸå›¾</p>
</li>
<li>
<p>DiskCacheStrategy.RESULT : åªç¼“å­˜å¤„ç†å›¾</p>
</li>
<li>
<p>BitmapPool : é¿å…åå¤åˆ›å»ºåŒæ ·å°ºå¯¸çš„bitmapè€Œç»´æŠ¤çš„ä¸€ä¸ªbitmapæ± .</p>
</li>
</ul>
<p>ğŸˆTips :Glideçš„è¯»å–ç¼“å­˜é¡ºåºæ˜¯ : å…ˆä»å†…å­˜ä¸­è¯»å–ç¼“å­˜,è‹¥æ²¡æœ‰å†ä»ç£ç›˜ä¸­è¯»å–,è‹¥æ²¡æœ‰å†ä»loadä¸­åŠ è½½ã€‚</p>
<ul>
<li>è®¾ç½®Glideåªä»ç¼“å­˜ä¸­åŠ è½½å›¾ç‰‡ï¼Œå¦åˆ™åŠ è½½å¤±è´¥ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>fragment<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>url<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">.</span>onlyRetrieveFromCache<span style="color:#719e07">(</span><span style="color:#cb4b16">true</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><ul>
<li>æ¸…ç†å†…å­˜ç¼“å­˜</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>get<span style="color:#719e07">(</span>context<span style="color:#719e07">).</span>clearMemory<span style="color:#719e07">();</span> <span style="color:#586e75">//éœ€è¦åœ¨ä¸»çº¿ç¨‹è¿è¡Œ
</span></span></span></code></pre></div><ul>
<li>æ¸…ç†ç£ç›˜ç¼“å­˜(éœ€è¦åœ¨å­çº¿ç¨‹è¿è¡Œ)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#719e07">new</span> AsyncTask<span style="color:#719e07">&lt;</span>Void<span style="color:#719e07">,</span> Void<span style="color:#719e07">,</span> Void<span style="color:#719e07">&gt;</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">protected</span> Void <span style="color:#268bd2">doInBackground</span><span style="color:#719e07">(</span>Void<span style="color:#719e07">...</span> params<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    Glide<span style="color:#719e07">.</span>get<span style="color:#719e07">(</span>applicationContext<span style="color:#719e07">).</span>clearDiskCache<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><ul>
<li>Glideå¯¹èµ„æºçš„é‡ç”¨æœºåˆ¶</li>
</ul>
<p>Glideé€šè¿‡Â <code>å¼•ç”¨è®¡æ•°æ³•</code>Â æ¥åˆ¤æ–­ä¸€ä¸ªèµ„æºæ˜¯å¦æ­£åœ¨è¢«ä½¿ç”¨ :</p>
<ul>
<li>å½“ä¸€ä¸ªèµ„æºé€šè¿‡ <code>into()</code>Â æ–¹æ³•åŠ è½½æ—¶,å®ƒçš„ <code>å¼•ç”¨è®¡æ•°</code>Â å°±ä¼š+1</li>
<li>å½“æ‰¿è½½èµ„æºAçš„ <code>View</code>Â æˆ–è€… <code>Target</code>Â è°ƒç”¨äº† <code>clear()</code>Â æˆ–è€…åˆè°ƒç”¨äº† <code>into()</code>Â åŠ è½½äº†åˆ«çš„èµ„æºæ—¶, Aèµ„æºçš„ <code>å¼•ç”¨è®¡æ•°</code>Â -1ã€‚</li>
</ul>
<p>å½“ä¸€ä¸ªèµ„æºçš„ è®¡æ•°ä¸º0æ—¶ï¼Œå°±ä¼šè¢«é‡Šæ”¾ï¼ŒGlideå¯ä»¥é‡ç”¨è¯¥èµ„æºã€‚</p>
<h2 id="6ä½¿ç”¨ç¼©ç•¥å›¾thumbnail">6.ä½¿ç”¨ç¼©ç•¥å›¾(Thumbnail)</h2>
<p>1.å½“ä½ å·²ç»æœ‰å›¾ç‰‡çš„ç¼©ç•¥å›¾çš„èµ„æºæ—¶,å¯ä»¥ç›´æ¥ç”¨url/uriåŠ è½½</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>GlideApp<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asDrawable<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>åŸå›¾url<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>thumbnail<span style="color:#719e07">(</span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>ç¼©ç•¥å›¾url<span style="color:#719e07">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><p>2.æ²¡æœ‰ç¼©ç•¥å›¾çš„èµ„æºæ—¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¼ å…¥æƒ³è¦ç¼©å°çš„å€æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asDrawable<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>mImageList<span style="color:#719e07">[</span>position<span style="color:#719e07">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>thumbnail<span style="color:#719e07">(</span><span style="color:#2aa198">0.1f</span><span style="color:#719e07">)</span>  <span style="color:#586e75">//ç¼©ç•¥å›¾å¤§å°ä¸ºåŸæ¥çš„ 1/10
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><h2 id="7target">7.Target</h2>
<p>Targetå¯¹è±¡ç”¨æ¥ä¿å­˜æ¯ä¸€ä¸ªGlideè¯·æ±‚ã€‚å¦‚:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Target<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> target <span style="color:#719e07">=</span> Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asDrawable<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_foreground<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><p>è¿™æ ·åšçš„ç›®çš„æ˜¯å¯ä»¥æœ‰æ•ˆçš„å¯¹glideè¯·æ±‚è¿›è¡Œç®¡ç†ï¼Œå–æ¶ˆè¯·æ±‚ï¼Œæ¸…ç†èµ„æºã€‚</p>
<ul>
<li>æ¸…ç†ä¹‹å‰çš„è¯·æ±‚ :Â </li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Target<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> target <span style="color:#719e07">=</span> Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asDrawable<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_foreground<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>fragment<span style="color:#719e07">).</span>clear<span style="color:#719e07">(</span>target<span style="color:#719e07">);</span>     <span style="color:#586e75">//æ¸…ç†ä¹‹å‰çš„åŠ è½½,èŠ‚çœèµ„æº
</span></span></span></code></pre></div><p>Â å½“ä½¿ç”¨è¿™ä¸ªtargetå†å‘å‡ºæ–°çš„åŠ è½½è¯·æ±‚æ—¶,glideä¹Ÿä¼šå¯¹ä¸Šä¸€æ¬¡çš„åŠ è½½è¿›è¡Œæ¸…ç†ï¼Œé‡Šæ”¾èµ„æºã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Target<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> target <span style="color:#719e07">=</span> Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>asDrawable<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_foreground<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>mImageList<span style="color:#719e07">[</span>position<span style="color:#719e07">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>fitCenter<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>target<span style="color:#719e07">);</span>
</span></span></code></pre></div><h2 id="8è¿‡æ¸¡åŠ¨ç”»transitions">8.è¿‡æ¸¡åŠ¨ç”»(Transitions)</h2>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£æè¿° , è¿‡æ¸¡åŠ¨ç”»åªèƒ½ä½œç”¨äºä¸€ä¸ªè¯·æ±‚ä¸­çš„(ä¸èƒ½ä½œç”¨äºå…ˆå2ä¸ªä¸åŒçš„è¯·æ±‚) :Â </p>
<ul>
<li>ä»å ä½ç¬¦-&gt;åŸå›¾çš„è¿‡ç¨‹</li>
<li>ä»ç¼©ç•¥å›¾-&gt;åŸå›¾çš„è¿‡ç¨‹</li>
</ul>
<p>ç¤ºä¾‹:
å¯ä»¥å‘ç°å ä½å›¾åˆ°åŸå›¾ä¹‹é—´çš„æ¸å˜æ•ˆæœ
<!-- raw HTML omitted --></p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Glide<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>mImageList<span style="color:#719e07">[</span>position<span style="color:#719e07">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>transition<span style="color:#719e07">(</span>withCrossFade<span style="color:#719e07">(</span><span style="color:#2aa198">600</span><span style="color:#719e07">))</span>  <span style="color:#586e75">//è®¾ç½®æ¸å˜çš„æŒç»­æ—¶é•¿600ms
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">.</span>placeholder<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_foreground<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>centerCrop<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><h2 id="9è‡ªå®šä¹‰module">9.è‡ªå®šä¹‰Module</h2>
<p>é€šè¿‡è‡ªå®šä¹‰moduleå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ ¹æ®é¡¹ç›®çš„å®é™…éœ€æ±‚æ¥å®šåˆ¶åŒ–glideã€‚</p>
<ol>
<li>é¦–å…ˆæ–°å»ºä¸€ä¸ªç±»ç»§æ‰¿ <code>AppGlideModule</code>Â ,å¹¶ç”¨ <code>@GlideModule</code>Â æ³¨è§£:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#586e75">/**
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"> * é€šè¿‡ç»§æ‰¿AppGlideModuleæ¥è‡ªå®šä¹‰Glide
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"> * @author chenyongda
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">@GlideModule</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">MyGlideApp</span> <span style="color:#268bd2">extends</span> AppGlideModule <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><ol start="2">
<li>å†é‡æ–° <code>ReBuild</code>Â ä¸€ä¸‹é¡¹ç›® ,å°†ä»£ç ä¸­ä¹‹å‰çš„ <code>Glide.with()</code>Â æ¢æˆ <code>GlideApp.with()</code>Â :</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>GlideApp<span style="color:#719e07">.</span>with<span style="color:#719e07">(</span>mContext<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>load<span style="color:#719e07">(</span>mImageList<span style="color:#719e07">[</span>position<span style="color:#719e07">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>placeholder<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>mipmap<span style="color:#719e07">.</span>ic_launcher<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>error<span style="color:#719e07">(</span>R<span style="color:#719e07">.</span>drawable<span style="color:#719e07">.</span>ic_launcher_background<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">.</span>into<span style="color:#719e07">(</span>holder<span style="color:#719e07">.</span>imageView<span style="color:#719e07">);</span>
</span></span></code></pre></div><ol start="3">
<li>åœ¨applyIOptions()ä¸­è¿›è¡Œè‡ªå®šä¹‰é…ç½®:</li>
</ol>
<p>æ¯”å¦‚,æˆ‘ä»¬æƒ³è®©glideé»˜è®¤æƒ…å†µä¸‹ä¸è¿›è¡Œä»»ä½•ç¼“å­˜ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">applyOptions</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">,</span> <span style="color:#268bd2">@NonNull</span> GlideBuilder builder<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//ä¸ç¼“å­˜å›¾ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    RequestOptions options <span style="color:#719e07">=</span> <span style="color:#719e07">new</span> RequestOptions<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#586e75">//ä¸è¿›è¡Œå†…å­˜ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>        <span style="color:#719e07">.</span>skipMemoryCache<span style="color:#719e07">(</span><span style="color:#cb4b16">true</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#586e75">//ä¸è¿›è¡Œç£ç›˜ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>        <span style="color:#719e07">.</span>diskCacheStrategy<span style="color:#719e07">(</span>DiskCacheStrategy<span style="color:#719e07">.</span>NONE<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    builder<span style="color:#719e07">.</span>setDefaultRequestOptions<span style="color:#719e07">(</span>options<span style="color:#719e07">);</span> <span style="color:#586e75">//è®¾ç½®ä¸ºé»˜è®¤é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>åœ¨ <code>applyOptions()</code>Â å‡½æ•°ä¸­è¿˜å¯ä»¥å¯¹ç¼“å­˜æ ¹æ®éœ€è¦è¿›è¡Œè‡ªå®šä¹‰</p>
<p>è‡ªå®šä¹‰å†…å­˜ç¼“å­˜ï¼š</p>
<p>æœ€å¤§ç¼“å­˜20mçš„å›¾ç‰‡</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">applyOptions</span><span style="color:#719e07">(</span>Context context<span style="color:#719e07">,</span> GlideBuilder builder<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#dc322f">int</span> memoryCacheSizeBytes <span style="color:#719e07">=</span> <span style="color:#2aa198">1024</span> <span style="color:#719e07">*</span> <span style="color:#2aa198">1024</span> <span style="color:#719e07">*</span> <span style="color:#2aa198">20</span><span style="color:#719e07">;</span> <span style="color:#586e75">// 20mb
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    builder<span style="color:#719e07">.</span>setMemoryCache<span style="color:#719e07">(</span><span style="color:#719e07">new</span> LruResourceCache<span style="color:#719e07">(</span>memoryCacheSizeBytes<span style="color:#719e07">));</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><h1 id="äºŒæºç è§£æ">äºŒ.æºç è§£æ</h1>
<h2 id="1glidewith--glideçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†">1.Glide.with() : Glideçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†</h2>
<p>è¿›å…¥Glide.with()æ–¹æ³• :</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#268bd2">static</span> RequestManager <span style="color:#268bd2">with</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> getRetriever<span style="color:#719e07">(</span>context<span style="color:#719e07">).</span>get<span style="color:#719e07">(</span>context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>é¦–å…ˆçœ‹ä¸€ä¸‹ <code>getRetriever()</code>Â æ–¹æ³•:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#268bd2">static</span> RequestManagerRetriever <span style="color:#268bd2">getRetriever</span><span style="color:#719e07">(</span><span style="color:#268bd2">@Nullable</span> Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">// Context could be null for other reasons (ie the user passes in null), but in practice it will
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#586e75">// only occur due to errors with the Fragment lifecycle.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Preconditions<span style="color:#719e07">.</span>checkNotNull<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>        context<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#2aa198">&#34;You cannot start a load on a not yet attached View or a Fragment where getActivity() &#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;returns null (which usually occurs when getActivity() is called before the Fragment &#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;is attached or after the Fragment is destroyed).&#34;</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> Glide<span style="color:#719e07">.</span>get<span style="color:#719e07">(</span>context<span style="color:#719e07">).</span>getRequestManagerRetriever<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>é€šè¿‡æ³¨é‡Šäº†è§£åˆ° :è¿™ä¸ªæ–¹æ³•å…ˆå¯¹contextè¿›è¡Œåˆ¤ç©º,ä¹Ÿå°±æ˜¯å½“viewè¿˜æ²¡åŠ è½½æ—¶æˆ–è€…fragmentè¿˜æ²¡ä¸activityå»ºç«‹è”ç³»æ—¶ã€‚</p>
<p>çœ‹ä¸€ä¸‹ <code>Glide.get(context)</code>Â æ–¹æ³• :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#586e75">/**
</span></span></span><span style="display:flex;"><span><span style="color:#586e75">   * Get the singleton.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75">   *
</span></span></span><span style="display:flex;"><span><span style="color:#586e75">   * @return the singleton
</span></span></span><span style="display:flex;"><span><span style="color:#586e75">   */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#268bd2">static</span> Glide <span style="color:#268bd2">get</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>glide <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">synchronized</span> <span style="color:#719e07">(</span>Glide<span style="color:#719e07">.</span>class<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>glide <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>          checkAndInitializeGlide<span style="color:#719e07">(</span>context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> glide<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è¿™æ˜¯ä¸€ä¸ªDCLåŒé‡æ£€éªŒé”çš„å•ä¾‹æ¨¡å¼ ã€‚</p>
<p><code>checkAndInitializeGlide()</code>Â æ–¹æ³• :Â Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">private</span> <span style="color:#268bd2">static</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">checkAndInitializeGlide</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">// In the thread running initGlide(), one or more classes may call Glide.get(context).
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#586e75">// Without this check, those calls could trigger infinite recursion.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>isInitializing<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">throw</span> <span style="color:#719e07">new</span> IllegalStateException<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;You cannot call Glide.get() in registerComponents(),&#34;</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34; use the provided Glide instance instead&#34;</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    isInitializing <span style="color:#719e07">=</span> <span style="color:#cb4b16">true</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    initializeGlide<span style="color:#719e07">(</span>context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    isInitializing <span style="color:#719e07">=</span> <span style="color:#cb4b16">false</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ–¹æ³•ç”¨æ¥ä¿è¯glideåœ¨åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨åˆå§‹åŒ–å®ƒã€‚</p>
<p>RequestManagerRetriever :Â 
è¿™ä¸ªç±»æ˜¯ Glide çš„ä¸€ä¸ªè¾…åŠ©ç±»ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>RequestManager</code>Â å¯¹è±¡æˆ–è€…è·å¾—ä¸€ä¸ªå·²å­˜åœ¨çš„ acitivity/fragment , é‚£ <code>RequestManager</code>å°†è¯·æ±‚ä¸activity/fragmentç­‰ç»„ä»¶å»ºç«‹è”ç³»ã€‚</p>
<p>å†çœ‹ä¸€ä¸‹ RequestMangerRetrieverç±»çš„get()æ–¹æ³• :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestManager <span style="color:#268bd2">get</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>context <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">throw</span> <span style="color:#719e07">new</span> IllegalArgumentException<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;You cannot start a load on a null Context&#34;</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>Util<span style="color:#719e07">.</span>isOnMainThread<span style="color:#719e07">()</span> <span style="color:#719e07">&amp;&amp;</span> <span style="color:#719e07">!(</span>context <span style="color:#719e07">instanceof</span> Application<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>context <span style="color:#719e07">instanceof</span> FragmentActivity<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">return</span> get<span style="color:#719e07">((</span>FragmentActivity<span style="color:#719e07">)</span> context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>context <span style="color:#719e07">instanceof</span> Activity<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">return</span> get<span style="color:#719e07">((</span>Activity<span style="color:#719e07">)</span> context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>context <span style="color:#719e07">instanceof</span> ContextWrapper<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">return</span> get<span style="color:#719e07">(((</span>ContextWrapper<span style="color:#719e07">)</span> context<span style="color:#719e07">).</span>getBaseContext<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> getApplicationManager<span style="color:#719e07">(</span>context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ–¹æ³•é€šè¿‡å°†æˆ‘ä»¬ä¼ å…¥çš„ context ï¼Œè½¬æ¢ä¸ºä¸ application/activity/fragmentå»ºç«‹è”ç³»çš„ <code>ReuqestManger</code>Â ç±» ,åŠ å…¥æˆ‘ä»¬ä¼ å…¥çš„æ˜¯ activity,ç‚¹è¿›ç¬¬ 9 è¡Œä»£ç  :</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestManager <span style="color:#268bd2">get</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Activity activity<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>Util<span style="color:#719e07">.</span>isOnBackgroundThread<span style="color:#719e07">())</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#586e75">//å½“æˆ‘ä»¬åœ¨å­çº¿ç¨‹ç”¨glide,glideä¼šæŠŠè¯·æ±‚ä¸æ•´ä¸ªappçš„ç”Ÿå‘½å‘¨æœŸå»ºç«‹è”ç³».
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">return</span> get<span style="color:#719e07">(</span>activity<span style="color:#719e07">.</span>getApplicationContext<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      assertNotDestroyed<span style="color:#719e07">(</span>activity<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#586e75">//ç”¨äºåˆ›å»ºfragment
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      android<span style="color:#719e07">.</span>app<span style="color:#719e07">.</span>FragmentManager fm <span style="color:#719e07">=</span> activity<span style="color:#719e07">.</span>getFragmentManager<span style="color:#719e07">();</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">return</span> fragmentGet<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>          activity<span style="color:#719e07">,</span> fm<span style="color:#719e07">,</span> <span style="color:#586e75">/*parentHint=*/</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">,</span> isActivityVisible<span style="color:#719e07">(</span>activity<span style="color:#719e07">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>ç‚¹è¿›ç¬¬8è¡Œçš„ <code>fragmentGet()</code>Â :</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">private</span> RequestManager <span style="color:#268bd2">fragmentGet</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> Context context<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@NonNull</span> android<span style="color:#719e07">.</span>app<span style="color:#719e07">.</span>FragmentManager fm<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@Nullable</span> android<span style="color:#719e07">.</span>app<span style="color:#719e07">.</span>Fragment parentHint<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#dc322f">boolean</span> isParentVisible<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//åˆ›å»ºä¸€ä¸ªéšè—çš„Fragment
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    RequestManagerFragment current <span style="color:#719e07">=</span> getRequestManagerFragment<span style="color:#719e07">(</span>fm<span style="color:#719e07">,</span> parentHint<span style="color:#719e07">,</span> isParentVisible<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    RequestManager requestManager <span style="color:#719e07">=</span> current<span style="color:#719e07">.</span>getRequestManager<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//å¦‚æœè·å¾—çš„RequestManagerä¸ºç©ºçš„è¯å°±åˆ›å»ºä¸€ä¸ªã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>requestManager <span style="color:#719e07">==</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      Glide glide <span style="color:#719e07">=</span> Glide<span style="color:#719e07">.</span>get<span style="color:#719e07">(</span>context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>      requestManager <span style="color:#719e07">=</span>
</span></span><span style="display:flex;"><span>          factory<span style="color:#719e07">.</span>build<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>              glide<span style="color:#719e07">,</span> current<span style="color:#719e07">.</span>getGlideLifecycle<span style="color:#719e07">(),</span> current<span style="color:#719e07">.</span>getRequestManagerTreeNode<span style="color:#719e07">(),</span> context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>      	<span style="color:#586e75">//æŠŠRequestManagerèµ‹ç»™Fragment
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>        current<span style="color:#719e07">.</span>setRequestManager<span style="color:#719e07">(</span>requestManager<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> requestManager<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>åˆ°è¿™é‡Œå¯ä»¥å‘ç° Glideä¸activityå»ºç«‹è”ç³»çš„å…³é”®åœ¨äº:</p>
<ol>
<li>åˆ›å»ºäº†ä¸€ä¸ªæ— UIçš„FragmentÂ </li>
<li>åˆ›å»ºäº†ä¸€ä¸ª <code>RequestManager</code>Â ,å¹¶é€šè¿‡ <code>current.getGlideLifecycle()</code>Â å°†fragmentçš„ <code>ActivityFragmentLifecycle</code>Â æˆå‘˜ä¼ ç»™äº† <code>RequestManager</code>Â ã€‚</li>
<li>æ— UIçš„Fragmenté€šè¿‡ <code>setRequestManager()</code>Â ä¸ <code>RequestManager</code>Â å»ºç«‹è”ç³»ã€‚</li>
</ol>
<p>ç¬¬12è¡Œä»£ç ä¸­åˆ›å»º <code>RequestManager</code>Â å¯¹è±¡æ—¶ è°ƒç”¨äº† <code>RequestManager</code>Â çš„æ„é€ æ–¹æ³• :Â </p>
<p>æ„é€ æ–¹æ³•çš„22è¡Œè°ƒç”¨äº†<code>ActivityFragmentLifecycle</code>Â çš„ addListener()æ–¹æ³•å°† <code>RequestManager</code>Â æ·»åŠ åˆ°è‡ªå·±çš„ç›‘å¬å™¨åˆ—è¡¨ä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  RequestManager<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>      Glide glide<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      Lifecycle lifecycle<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      RequestManagerTreeNode treeNode<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      RequestTracker requestTracker<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      ConnectivityMonitorFactory factory<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      Context context<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>glide <span style="color:#719e07">=</span> glide<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>lifecycle <span style="color:#719e07">=</span> lifecycle<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>treeNode <span style="color:#719e07">=</span> treeNode<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>requestTracker <span style="color:#719e07">=</span> requestTracker<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>context <span style="color:#719e07">=</span> context<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    connectivityMonitor <span style="color:#719e07">=</span>
</span></span><span style="display:flex;"><span>        factory<span style="color:#719e07">.</span>build<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>            context<span style="color:#719e07">.</span>getApplicationContext<span style="color:#719e07">(),</span>
</span></span><span style="display:flex;"><span>            <span style="color:#719e07">new</span> RequestManagerConnectivityListener<span style="color:#719e07">(</span>requestTracker<span style="color:#719e07">));</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>Util<span style="color:#719e07">.</span>isOnBackgroundThread<span style="color:#719e07">())</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      mainHandler<span style="color:#719e07">.</span>post<span style="color:#719e07">(</span>addSelfToLifecycle<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#586e75">//å°† RequestManager æ·»åŠ åˆ°è‡ªå·±çš„ç›‘å¬å™¨åˆ—è¡¨ä¸­ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      lifecycle<span style="color:#719e07">.</span>addListener<span style="color:#719e07">(</span><span style="color:#719e07">this</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    lifecycle<span style="color:#719e07">.</span>addListener<span style="color:#719e07">(</span>connectivityMonitor<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    defaultRequestListeners <span style="color:#719e07">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">new</span> CopyOnWriteArrayList<span style="color:#719e07">&lt;&gt;(</span>glide<span style="color:#719e07">.</span>getGlideContext<span style="color:#719e07">().</span>getDefaultRequestListeners<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>    setRequestOptions<span style="color:#719e07">(</span>glide<span style="color:#719e07">.</span>getGlideContext<span style="color:#719e07">().</span>getDefaultRequestOptions<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    glide<span style="color:#719e07">.</span>registerRequestManager<span style="color:#719e07">(</span><span style="color:#719e07">this</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>ä¸ºäº†çœ‹æ¸…æ¥šGlideæ˜¯å¦‚ä½•ä¸ç»„ä»¶activity/fragmentå»ºç«‹ç”Ÿå‘½å‘¨æœŸè”ç³»ï¼Œæˆ‘ä»¬å…ˆä»åˆšåˆšçš„æ— UIçš„Fragment-&gt;
<code>RequestManagerFragment</code>Â è¿™ä¸ªç±»çš„ç”Ÿå‘½å‘¨æœŸçœ‹èµ· :</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">RequestManagerFragment</span> <span style="color:#268bd2">extends</span> Fragment <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#268bd2">static</span> <span style="color:#268bd2">final</span> String TAG <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;SupportRMFragment&#34;</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#268bd2">final</span> ActivityFragmentLifecycle lifecycle<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStart</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">super</span><span style="color:#719e07">.</span>onStart<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    lifecycle<span style="color:#719e07">.</span>onStart<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStop</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">super</span><span style="color:#719e07">.</span>onStop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    lifecycle<span style="color:#719e07">.</span>onStop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onDestroy</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">super</span><span style="color:#719e07">.</span>onDestroy<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    lifecycle<span style="color:#719e07">.</span>onDestroy<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    unregisterFragmentWithRoot<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    	
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è¿™ä¸ªfragmentä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­,åˆè°ƒç”¨äº†å¯¹åº”çš„ <code>ActivityFragmentLifecycle</code>Â çš„æ–¹æ³• :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">class</span> <span style="color:#268bd2">ActivityFragmentLifecycle</span> <span style="color:#268bd2">implements</span> Lifecycle <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">private</span> <span style="color:#268bd2">final</span> Set<span style="color:#719e07">&lt;</span>LifecycleListener<span style="color:#719e07">&gt;</span> lifecycleListeners <span style="color:#719e07">=</span>
</span></span><span style="display:flex;"><span>      Collections<span style="color:#719e07">.</span>newSetFromMap<span style="color:#719e07">(</span><span style="color:#719e07">new</span> WeakHashMap<span style="color:#719e07">&lt;</span>LifecycleListener<span style="color:#719e07">,</span> Boolean<span style="color:#719e07">&gt;());</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#dc322f">boolean</span> isStarted<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#dc322f">boolean</span> isDestroyed
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">addListener</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> LifecycleListener listener<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    lifecycleListeners<span style="color:#719e07">.</span>add<span style="color:#719e07">(</span>listener<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>isDestroyed<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      listener<span style="color:#719e07">.</span>onDestroy<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>isStarted<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      listener<span style="color:#719e07">.</span>onStart<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      listener<span style="color:#719e07">.</span>onStop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">removeListener</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> LifecycleListener listener<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    lifecycleListeners<span style="color:#719e07">.</span>remove<span style="color:#719e07">(</span>listener<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStart</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    isStarted <span style="color:#719e07">=</span> <span style="color:#cb4b16">true</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">for</span> <span style="color:#719e07">(</span>LifecycleListener lifecycleListener <span style="color:#719e07">:</span> Util<span style="color:#719e07">.</span>getSnapshot<span style="color:#719e07">(</span>lifecycleListeners<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      lifecycleListener<span style="color:#719e07">.</span>onStart<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStop</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    isStarted <span style="color:#719e07">=</span> <span style="color:#cb4b16">false</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">for</span> <span style="color:#719e07">(</span>LifecycleListener lifecycleListener <span style="color:#719e07">:</span> Util<span style="color:#719e07">.</span>getSnapshot<span style="color:#719e07">(</span>lifecycleListeners<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      lifecycleListener<span style="color:#719e07">.</span>onStop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#dc322f">void</span> <span style="color:#268bd2">onDestroy</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    isDestroyed <span style="color:#719e07">=</span> <span style="color:#cb4b16">true</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">for</span> <span style="color:#719e07">(</span>LifecycleListener lifecycleListener <span style="color:#719e07">:</span> Util<span style="color:#719e07">.</span>getSnapshot<span style="color:#719e07">(</span>lifecycleListeners<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      lifecycleListener<span style="color:#719e07">.</span>onDestroy<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p><code>ActivityFragmentLifecycle</code>Â ä¸­æœ‰ä¸€ä¸ª <code>Set&lt;LifecycleListener&gt;</code>Â ç±»å‹çš„é›†åˆ,è€Œ <code>RequestManager</code>Â ä¹Ÿæ­£å¥½å®ç°äº† <code>LifecycleListener</code>Â è¿™ä¸ªæ¥å£ ,çœ‹ä¸€ä¸‹ <code>RequestManager</code>Â ä¸­çš„ <code>onStart()</code>Â æ–¹æ³• :Â </p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#268bd2">synchronized</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStart</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//å¤„ç†è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    resumeRequests<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    targetTracker<span style="color:#719e07">.</span>onStart<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#268bd2">synchronized</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">onStop</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    pauseRequests<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    targetTracker<span style="color:#719e07">.</span>onStop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#268bd2">synchronized</span> <span style="color:#dc322f">void</span> <span style="color:#268bd2">resumeRequests</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    requestTracker<span style="color:#719e07">.</span>resumeRequests<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">...</span>
</span></span></code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2019/webp/334982/1573460183383-c4cb601a-7b5e-4fa5-8f61-60ac75603667.webp#align=left&amp;display=inline&amp;height=238&amp;originHeight=238&amp;originWidth=1078&amp;search=&amp;size=0&amp;status=done&amp;width=1078" alt="">
æ‰€ä»¥ç°åœ¨å¯ä»¥çœ‹å‡º,Glideä¸ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³è”çš„æ–¹æ³•æ˜¯åŸºäºç±»ä¼¼é“¾å¼çš„ç»“æ„ã€‚</p>
<ol>
<li>Activityçš„ç”Ÿå‘½å‘¨æœŸä¼šå¼•èµ·æ— UIçš„Fragmentçš„ç”Ÿå‘½å‘¨æœŸå˜åŒ–.</li>
<li>Fragmentçš„ç”Ÿå‘½å‘¨æœŸä¼šä¼šè°ƒç”¨è‡ªå·±æˆå‘˜å˜é‡ <code>ActivityFragmentLifecycle</code>Â ä¸­å¯¹åº”çš„onXXX()æ–¹æ³•.</li>
<li><code>ActivityFragmentLifecycle</code>Â çš„onXXX()æ–¹æ³•å†…éƒ¨åˆè°ƒç”¨äº† <code>RequestManager</code>Â çš„æ–¹æ³•ã€‚</li>
</ol>
<h2 id="2loadurl-">2.load(url) :Â </h2>
<p>åœ¨load()è¿™ä¸€ç¯èŠ‚éœ€è¦æˆ‘ä»¬ä¼ å…¥éœ€è¦åŠ è½½çš„å›¾ç‰‡çš„é“¾æ¥.</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestBuilder<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">load</span><span style="color:#719e07">(</span><span style="color:#268bd2">@Nullable</span> String string<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> asDrawable<span style="color:#719e07">().</span>load<span style="color:#719e07">(</span>string<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>loadæ–¹æ³•é»˜è®¤è°ƒç”¨äº† <code>asDrawable()</code>Â æ–¹æ³• :Â </p>
<p>æ–¹æ³•ä¸»è¦ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªåŠ è½½ <code>Drawable</code>Â èµ„æºç±»å‹çš„ <code>RequestBuilder</code>Â ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestBuilder<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">asDrawable</span><span style="color:#719e07">()</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> as<span style="color:#719e07">(</span>Drawable<span style="color:#719e07">.</span>class<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#719e07">&lt;</span>ResourceType<span style="color:#719e07">&gt;</span> RequestBuilder<span style="color:#719e07">&lt;</span>ResourceType<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">as</span><span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@NonNull</span> Class<span style="color:#719e07">&lt;</span>ResourceType<span style="color:#719e07">&gt;</span> resourceClass<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> <span style="color:#719e07">new</span> RequestBuilder<span style="color:#719e07">&lt;&gt;(</span>glide<span style="color:#719e07">,</span> <span style="color:#719e07">this</span><span style="color:#719e07">,</span> resourceClass<span style="color:#719e07">,</span> context<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>æŸ¥çœ‹ä¸€ä¸‹ <code>load()</code>Â æ–¹æ³• :Â </p>
<p>å°†Stringå­—ç¬¦ä¸²èµ‹äºˆmodelå˜é‡</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestBuilder<span style="color:#719e07">&lt;</span>TranscodeType<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">load</span><span style="color:#719e07">(</span><span style="color:#268bd2">@Nullable</span> String string<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> loadGeneric<span style="color:#719e07">(</span>string<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> RequestBuilder<span style="color:#719e07">&lt;</span>TranscodeType<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">loadGeneric</span><span style="color:#719e07">(</span><span style="color:#268bd2">@Nullable</span> Object model<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">this</span><span style="color:#719e07">.</span>model <span style="color:#719e07">=</span> model<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    isModelSet <span style="color:#719e07">=</span> <span style="color:#cb4b16">true</span><span style="color:#719e07">;</span><span style="color:#586e75">//è¿™ä¸ªå˜é‡è¡¨ç¤ºå·²ç»è°ƒç”¨è¿‡load(),åœ¨into()ä¸­ä¼šå†æ¬¡ç”¨åˆ°æ­¤å˜é‡ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">return</span> <span style="color:#719e07">this</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è€Œè¿™ä¸ªmodelå˜é‡å°†åœ¨åé¢çš„ <code>into()</code>Â ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="3into">3.into()</h2>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#268bd2">public</span> ViewTarget<span style="color:#719e07">&lt;</span>ImageView<span style="color:#719e07">,</span> TranscodeType<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">into</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> ImageView view<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯åœ¨ä¸»çº¿ç¨‹,å› ä¸ºè¿™é‡Œæ¶‰åŠåˆ°æ”¹å˜UI
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Util<span style="color:#719e07">.</span>assertMainThread<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//æ£€æŸ¥ImageViewæ˜¯å¦ä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Preconditions<span style="color:#719e07">.</span>checkNotNull<span style="color:#719e07">(</span>view<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    BaseRequestOptions<span style="color:#719e07">&lt;?&gt;</span> requestOptions <span style="color:#719e07">=</span> <span style="color:#719e07">this</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(!</span>requestOptions<span style="color:#719e07">.</span>isTransformationSet<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">&amp;&amp;</span> requestOptions<span style="color:#719e07">.</span>isTransformationAllowed<span style="color:#719e07">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">&amp;&amp;</span> view<span style="color:#719e07">.</span>getScaleType<span style="color:#719e07">()</span> <span style="color:#719e07">!=</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#586e75">// Clone in this method so that if we use this RequestBuilder to load into a View and then
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#586e75">// into a different target, we don&#39;t retain the transformation applied based on the previous
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#586e75">// View&#39;s scale type.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">switch</span> <span style="color:#719e07">(</span>view<span style="color:#719e07">.</span>getScaleType<span style="color:#719e07">())</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> CENTER_CROP<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>          requestOptions <span style="color:#719e07">=</span> requestOptions<span style="color:#719e07">.</span>clone<span style="color:#719e07">().</span>optionalCenterCrop<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>          <span style="color:#719e07">break</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> CENTER_INSIDE<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>          requestOptions <span style="color:#719e07">=</span> requestOptions<span style="color:#719e07">.</span>clone<span style="color:#719e07">().</span>optionalCenterInside<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>          <span style="color:#719e07">break</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> FIT_CENTER<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> FIT_START<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> FIT_END<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>          requestOptions <span style="color:#719e07">=</span> requestOptions<span style="color:#719e07">.</span>clone<span style="color:#719e07">().</span>optionalFitCenter<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>          <span style="color:#719e07">break</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> FIT_XY<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>          requestOptions <span style="color:#719e07">=</span> requestOptions<span style="color:#719e07">.</span>clone<span style="color:#719e07">().</span>optionalCenterInside<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>          <span style="color:#719e07">break</span><span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> CENTER<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">case</span> MATRIX<span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">default</span><span style="color:#719e07">:</span>
</span></span><span style="display:flex;"><span>          <span style="color:#586e75">// Do nothing.
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> into<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#586e75">//ç”±ImageViewæ„å»ºå‡ºTarget
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>        glideContext<span style="color:#719e07">.</span>buildImageViewTarget<span style="color:#719e07">(</span>view<span style="color:#719e07">,</span> transcodeClass<span style="color:#719e07">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#586e75">/*targetListener=*/</span> <span style="color:#cb4b16">null</span><span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>        requestOptions<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>        Executors<span style="color:#719e07">.</span>mainThreadExecutor<span style="color:#719e07">());</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div><p>è¿™é‡Œçš„into()æ–¹æ³•åªæ˜¯æ ¹æ®ImageViewçš„æ¯”ä¾‹ç±»å‹ï¼Œå¯¹ <code>RequestOptions</code>Â è¿›è¡Œé…ç½®ã€‚</p>
<p>36è¡Œçš„into()æ–¹æ³•ä¸­ç”¨ <code>GlideContext</code>Â çš„ <code>buildImageViewTarget()</code>Â ç”¨ ImageView æ„å»ºå‡º Target.</p>
<p>çœ‹ä¸€ä¸‹è¿™ä¸ªæ–¹æ³• :</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#719e07">&lt;</span>X<span style="color:#719e07">&gt;</span> ViewTarget<span style="color:#719e07">&lt;</span>ImageView<span style="color:#719e07">,</span> X<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">buildImageViewTarget</span><span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@NonNull</span> ImageView imageView<span style="color:#719e07">,</span> <span style="color:#268bd2">@NonNull</span> Class<span style="color:#719e07">&lt;</span>X<span style="color:#719e07">&gt;</span> transcodeClass<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> imageViewTargetFactory<span style="color:#719e07">.</span>buildTarget<span style="color:#719e07">(</span>imageView<span style="color:#719e07">,</span> transcodeClass<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2">public</span> <span style="color:#268bd2">class</span> <span style="color:#268bd2">ImageViewTargetFactory</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@NonNull</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">@SuppressWarnings</span><span style="color:#719e07">(</span><span style="color:#2aa198">&#34;unchecked&#34;</span><span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> <span style="color:#719e07">&lt;</span>Z<span style="color:#719e07">&gt;</span> ViewTarget<span style="color:#719e07">&lt;</span>ImageView<span style="color:#719e07">,</span> Z<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">buildTarget</span><span style="color:#719e07">(</span><span style="color:#268bd2">@NonNull</span> ImageView view<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@NonNull</span> Class<span style="color:#719e07">&lt;</span>Z<span style="color:#719e07">&gt;</span> clazz<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>Bitmap<span style="color:#719e07">.</span>class<span style="color:#719e07">.</span>equals<span style="color:#719e07">(</span>clazz<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>      <span style="color:#586e75">//Bitmapç±»å‹çš„ViewTarget
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">return</span> <span style="color:#719e07">(</span>ViewTarget<span style="color:#719e07">&lt;</span>ImageView<span style="color:#719e07">,</span> Z<span style="color:#719e07">&gt;)</span> <span style="color:#719e07">new</span> BitmapImageViewTarget<span style="color:#719e07">(</span>view<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>Drawable<span style="color:#719e07">.</span>class<span style="color:#719e07">.</span>isAssignableFrom<span style="color:#719e07">(</span>clazz<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>          <span style="color:#586e75">//Drawableç±»å‹çš„ViewTarget
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">return</span> <span style="color:#719e07">(</span>ViewTarget<span style="color:#719e07">&lt;</span>ImageView<span style="color:#719e07">,</span> Z<span style="color:#719e07">&gt;)</span> <span style="color:#719e07">new</span> DrawableImageViewTarget<span style="color:#719e07">(</span>view<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span> <span style="color:#719e07">else</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">throw</span> <span style="color:#719e07">new</span> IllegalArgumentException<span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>          <span style="color:#2aa198">&#34;Unhandled class: &#34;</span> <span style="color:#719e07">+</span> clazz <span style="color:#719e07">+</span> <span style="color:#2aa198">&#34;, try .as*(Class).transcode(ResourceTranscoder)&#34;</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span><span style="color:#719e07">}</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹å‡º <code>ImageViewTargetFactory</code> è¿™ä¸ªç±»å°±æ˜¯ç”¨æ¥æŠŠ <code>ImageView</code> è½¬åŒ–ä¸º2ç§(Bitmap,Drawable) ç±»å‹çš„ ViewTargetçš„ã€‚</p>
<blockquote>
<p>è€Œæˆ‘ä»¬ä¹‹å‰åœ¨åˆ†æ <code>load()</code> æ–¹æ³•æ—¶çœ‹åˆ°é»˜è®¤æƒ…å†µä¸‹æŠŠèµ„æºå½“ä½œ Drawable ç±»å‹å¤„ç† , æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ç”Ÿæˆçš„ <code>DrawableImageViewTarget</code> ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">@Override</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">public</span> RequestBuilder<span style="color:#719e07">&lt;</span>Drawable<span style="color:#719e07">&gt;</span> <span style="color:#268bd2">load</span><span style="color:#719e07">(</span><span style="color:#268bd2">@Nullable</span> String string<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> asDrawable<span style="color:#719e07">().</span>load<span style="color:#719e07">(</span>string<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div></blockquote>
<p>ç»§ç»­æ·±å…¥ä¹‹å‰çš„ into() æ–¹æ³•ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#268bd2">private</span> <span style="color:#719e07">&lt;</span>Y <span style="color:#268bd2">extends</span> Target<span style="color:#719e07">&lt;</span>TranscodeType<span style="color:#719e07">&gt;&gt;</span> Y <span style="color:#268bd2">into</span><span style="color:#719e07">(</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2">@NonNull</span> Y target<span style="color:#719e07">,</span> <span style="color:#586e75">//æŠŠåˆ›å»ºçš„Targetä¼ è¿›æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#268bd2">@Nullable</span> RequestListener<span style="color:#719e07">&lt;</span>TranscodeType<span style="color:#719e07">&gt;</span> targetListener<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      BaseRequestOptions<span style="color:#719e07">&lt;?&gt;</span> options<span style="color:#719e07">,</span>
</span></span><span style="display:flex;"><span>      Executor callbackExecutor<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//Targetä¸èƒ½ä¸ºç©º
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Preconditions<span style="color:#719e07">.</span>checkNotNull<span style="color:#719e07">(</span>target<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">// isModelSetåœ¨load()è¢«è°ƒç”¨è¿‡æ‰ä¼šä¸ºtrue
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(!</span>isModelSet<span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">throw</span> <span style="color:#719e07">new</span> IllegalArgumentException<span style="color:#719e07">(</span><span style="color:#2aa198">&#34;You must call #load() before calling #into()&#34;</span><span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#586e75">//åˆ›å»ºRequestå¯¹è±¡ , ç¨åè§£æ
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Request request <span style="color:#719e07">=</span> buildRequest<span style="color:#719e07">(</span>target<span style="color:#719e07">,</span> targetListener<span style="color:#719e07">,</span> options<span style="color:#719e07">,</span> callbackExecutor<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#586e75">//è·å–æ­¤ImageViewçš„ä¹‹å‰çš„è¯·æ±‚å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    Request previous <span style="color:#719e07">=</span> target<span style="color:#719e07">.</span>getRequest<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#586e75">//å¦‚æœæ­¤æ¬¡çš„è¯·æ±‚å’Œä¹‹å‰çš„è¯·æ±‚ç›¸åŒå¹¶ä¸”å¯ç”¨äº†å†…å­˜ç¼“å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    <span style="color:#719e07">if</span> <span style="color:#719e07">(</span>request<span style="color:#719e07">.</span>isEquivalentTo<span style="color:#719e07">(</span>previous<span style="color:#719e07">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#719e07">&amp;&amp;</span> <span style="color:#719e07">!</span>isSkipMemoryCacheWithCompletePreviousRequest<span style="color:#719e07">(</span>options<span style="color:#719e07">,</span> previous<span style="color:#719e07">))</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#586e75">//å›æ”¶è¯·æ±‚èµ„æº
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      request<span style="color:#719e07">.</span>recycle<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>     <span style="color:#586e75">//è‹¥ä¸Šä¸€æ¬¡çš„è¯·æ±‚æ²¡æœ‰åœ¨åŠ è½½ï¼Œåˆ™å†æ‰§è¡Œè¿™ä¸ªè¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>      <span style="color:#719e07">if</span> <span style="color:#719e07">(!</span>Preconditions<span style="color:#719e07">.</span>checkNotNull<span style="color:#719e07">(</span>previous<span style="color:#719e07">).</span>isRunning<span style="color:#719e07">())</span> <span style="color:#719e07">{</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        previous<span style="color:#719e07">.</span>begin<span style="color:#719e07">();</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#719e07">return</span> target<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#586e75">//è‹¥è¿™æ¬¡è¯·æ±‚ä¸ä¸Šæ¬¡ä¸åŒ,åˆ™å–æ¶ˆä¸Šä¸€æ¬¡è¯·æ±‚
</span></span></span><span style="display:flex;"><span><span style="color:#586e75"></span>    requestManager<span style="color:#719e07">.</span>clear<span style="color:#719e07">(</span>target<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    target<span style="color:#719e07">.</span>setRequest<span style="color:#719e07">(</span>request<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>    requestManager<span style="color:#719e07">.</span>track<span style="color:#719e07">(</span>target<span style="color:#719e07">,</span> request<span style="color:#719e07">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#719e07">return</span> target<span style="color:#719e07">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#719e07">}</span>
</span></span></code></pre></div>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Petrichor</span></span>
    
    <time>Nov 14, 2019</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="https://chenyongda2018.github.io/tags/android">Android</a>  <a class="category" href="https://chenyongda2018.github.io/tags/glide">Glide</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="https://chenyongda2018.github.io/posts/android/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9C%A8android%E4%B8%AD%E8%B0%83%E7%94%A8%E7%99%BE%E5%BA%A6%E7%9A%84ocr%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%BB%8F%E5%8E%86/" title="è®°ä¸€æ¬¡åœ¨Androidä¸­è°ƒç”¨ç™¾åº¦çš„OCRæ¥å£çš„ç»å†">è®°ä¸€æ¬¡åœ¨Androidä¸­è°ƒç”¨ç™¾åº¦çš„OCRæ¥å£çš„ç»å†</a>
    

    
      <a class="basic-alignment right" href="https://chenyongda2018.github.io/posts/java/%E5%AF%B9%E8%B1%A1%E5%9B%9E%E6%94%B6%E5%88%A4%E5%AE%9A%E4%B8%8E%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E7%AE%97%E6%B3%95-jvm%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01/" title="å¯¹è±¡å›æ”¶åˆ¤å®šä¸åƒåœ¾å›æ”¶ç®—æ³• JVMå­¦ä¹ ç¬”è®°[1]">å¯¹è±¡å›æ”¶åˆ¤å®šä¸åƒåœ¾å›æ”¶ç®—æ³• JVMå­¦ä¹ ç¬”è®°[1]</a>
    
  </p>
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    

    <p>
      
    </p>
  </section>

  
  



<ul class="sidebar-nav">
  <li class="sidebar-nav-item">
    <a target="_blank" rel="noopener noreferrer" href="https://github.com/chenyongda2018" title="https://github.com/chenyongda2018"><i class="fa fa-github fa-3x"></i></a>
    
    
    
    
    
    
    
    
    
    
    

  
  
  </li>
</ul>

  

  
    
      <section class="odd">
        
        
          <li>
            <a href="https://chenyongda2018.github.io/categories/" title="åˆ†ç±»" >åˆ†ç±»</a>
          </li>
        
      </section>
    
  

  
  
  
    
      <section class="even">
        <h1>Recent Posts</h1>
        <ul id="recent_posts">
          
          
        </ul>
      </section>
    
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2023 Petrichor - <a href="https://chenyongda2018.github.io/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

